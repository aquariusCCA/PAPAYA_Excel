# 📌 `ADDRESS` 函數語法：

> 在 Excel 中，`ADDRESS` 函數會回傳某個儲存格的位址（以文字的方式顯示），你只需要提供列號和欄號，它就會告訴你該儲存格的地址。

```excel
ADDRESS(row_num, column_num, [abs_num], [a1], [sheet_text])
```

| 參數         | 說明 |
|--------------|------|
| `row_num`    | 必填。列號，例如 3 代表第 3 列。 |
| `column_num` | 必填。欄號，例如 2 代表第 B 欄。 |
| `abs_num`    | 選填。參照類型，控制絕對/相對參照（預設為 1）。 |
| `a1`         | 選填。決定是否使用 A1 樣式（TRUE 表示 A1，FALSE 表示 R1C1）。 |
| `sheet_text` | 選填。加入工作表名稱。 |

---

### 📘 絕對/相對參照（`abs_num`）對應表：

| abs_num 值 | 類型               | 範例     |
|------------|--------------------|----------|
| 1          | 絕對列與欄         | `$B$3`   |
| 2          | 絕對列，相對欄     | `B$3`    |
| 3          | 相對列，絕對欄     | `$B3`    |
| 4          | 相對列與欄         | `B3`     |

---

### ✅ 範例一：基本用法

```excel
=ADDRESS(3, 2)
```

👉 結果為 `$B$3`，代表第 3 列、第 2 欄（B欄），使用絕對參照格式。

---

### ✅ 範例二：使用相對參照

```excel
=ADDRESS(3, 2, 4)
```

👉 結果為 `B3`，相對列與欄。

---

### ✅ 範例三：用 R1C1 樣式（而非 A1）

```excel
=ADDRESS(3, 2, 1, FALSE)
```

👉 結果為 `R3C2`

---

### ✅ 範例四：指定工作表名稱

```excel
=ADDRESS(3, 2, 1, TRUE, "工作表1")
```

👉 結果為 `'工作表1'!$B$3`

---


# 🧠 情境：查找某員工的名字，並取得該名字在表格中的儲存格位置

假設你有以下員工清單（放在 A1:A5）：

| A         |
|-----------|
| 員工姓名   |
| 王小明     |
| 張大華     |
| 李美麗     |
| 陳俊宏     |

---

### ✅ 目標：
輸入某個名字，比如「李美麗」，我們希望知道她在表格中是哪個儲存格。

---

### 🧩 步驟解析：

1. **使用 `MATCH` 找到名字在第幾列（從第2列開始）**
2. **用 `ADDRESS` 找出該列與第1欄的交集儲存格地址**

---

### 🧪 範例公式：

```excel
=ADDRESS(MATCH("李美麗", A2:A5, 0)+1, 1)
```

📌 說明：

- `MATCH("李美麗", A2:A5, 0)`：找出「李美麗」在 A2:A5 的第幾個（結果為 3）
- `+1`：因為 A2 是第 2 列，所以要補回真正的 Excel 列號（3 + 1 = 4）
- `1`：代表第 1 欄（也就是 A 欄）
- 最終會得到：`$A$4`

---

### 📎 延伸應用：找出值 + 該值所在的儲存格

如果你要同時顯示這個名字 **和它的儲存格位址**，可以這樣寫：

```excel
="找到：""" & INDEX(A2:A5, MATCH("李美麗", A2:A5, 0)) & """，位置：" & ADDRESS(MATCH("李美麗", A2:A5, 0)+1, 1)
```

👉 結果會是：

```
找到："李美麗"，位置：$A$4
```

這種用法在你要「找出某個值在表格中的精確位置」時特別實用，像是製作自動報表、比對資料錯誤位置、或在其他工作表中引用指定格子等等。

如果你想，我也可以幫你做「動態查找」的版本，比如輸入名字在某格，動態回傳位置。要試試看嗎？

---


# 補充說明：Excel INDEX + MATCH 函數
> `INDEX` 和 `MATCH` 是 Excel 中非常強大的查找與引用函數，兩個搭配使用比 `VLOOKUP` 更靈活，尤其在**橫向查找**或**資料結構會變動時**特別有用。

---

## 🔹 `INDEX` 函數

### ✅ 語法：
```excel
INDEX(array, row_num, [column_num])
```

| 參數         | 說明 |
|--------------|------|
| `array`      | 要從中取值的範圍 |
| `row_num`    | 指定第幾列的值 |
| `column_num` | 可選。指定第幾欄的值（對於多欄範圍）|

### ✅ 範例：

假設下表在範圍 `A1:C4`：

| A      | B        | C       |
|--------|----------|---------|
| 姓名   | 部門     | 薪資    |
| 王小明 | 業務部   | 50000   |
| 張大華 | 行政部   | 42000   |
| 李美麗 | 財務部   | 55000   |

```excel
=INDEX(A2:C4, 2, 3)
```

👉 結果是：`42000`（因為是第2列第3欄的值）

---

## 🔹 `MATCH` 函數

### ✅ 語法：
```excel
MATCH(lookup_value, lookup_array, [match_type])
```

| 參數            | 說明 |
|-----------------|------|
| `lookup_value`  | 要找的值 |
| `lookup_array`  | 要在哪個範圍中找 |
| `match_type`    | 0=完全符合，1=小於等於，-1=大於等於 |

> 💡 最常用的是 `0`，表示**完全比對**

### ✅ 範例：

```excel
=MATCH("張大華", A2:A4, 0)
```

👉 結果是：`2`（因為張大華在 A2:A4 的第二列）

---

## 🔸 搭配應用：INDEX + MATCH

### 🎯 情境：根據姓名找出對應的薪資

```excel
=INDEX(C2:C4, MATCH("李美麗", A2:A4, 0))
```

📌 說明：

- `MATCH("李美麗", A2:A4, 0)` 會找出李美麗在第幾列（結果是3）
- `INDEX(C2:C4, 3)` 則是回傳薪資欄第3列的值（結果是 `55000`）

👉 結果：`55000`

---

## ✅ 動態查詢範例（輸入名字自動查找薪資）

假設：

- A2:A4 是名字
- C2:C4 是薪資
- E1 儲存格輸入要查詢的名字（如「張大華」）

```excel
=INDEX(C2:C4, MATCH(E1, A2:A4, 0))
```

👉 結果會依照 E1 的內容自動顯示對應薪資

---

## 📎 INDEX + MATCH 比 VLOOKUP 更好用的原因：

| 項目 | INDEX + MATCH | VLOOKUP |
|------|----------------|---------|
| 支援左側查詢 | ✅ 是 | ❌ 否 |
| 插入列不影響結果 | ✅ 是 | ❌ 否 |
| 效能更快（大量資料） | ✅ 是 | ❌ 否 |
| 可橫向查找 | ✅ 是 | ❌ 否 |

---

如果你想要，我也可以示範「二維查找」（列+欄同時用 MATCH 找）或幫你做個小小表格模擬用起來如何。要試試嗎？

> `INDIRECT` 函數是 Excel 中一個非常實用的函數，它的主要功能是**根據文字字串建立一個參照**。也就是說，它可以將文字內容「轉換成真正的儲存格參照」。

---

# ✅ INDIRECT 函數語法：

```
INDIRECT(ref_text, [a1])
```

| 參數       | 說明 |
|------------|------|
| `ref_text` | 要參照的儲存格位址（以文字形式輸入）。 |
| `[a1]`     | 可選，表示是否使用 A1 參照樣式。若省略或為 TRUE，表示使用 A1；若為 FALSE，則使用 R1C1 參照樣式。 |

---

# 🧠 為什麼要用 INDIRECT？

當你想要根據其他儲存格的內容**動態取得資料**時，`INDIRECT` 就派上用場了。

---

# 📘 範例 1：動態參照不同儲存格

假設你有以下資料：

| A       | B       |
|---------|---------|
| Apple   | 100     |
| Banana  | 80      |
| Grape   | 90      |
| E1      | A2      |

在 E1 輸入的是「A2」，你想要取得 A2 的內容「Banana」。

在 F1 中輸入以下公式：

```excel
=INDIRECT(E1)
```

🔍 解釋：  
E1 的內容是「A2」，`INDIRECT(E1)` 就等於 `=A2`，結果會顯示「Banana」。

---

# 📘 範例 2：配合選單切換工作表

## 📘 目標

你希望可以在「主工作表」輸入工作表名稱（例如 Sheet1 或 Sheet2），  
然後 Excel 自動幫你抓取該工作表 A1 儲存格的內容。

---

## 🧾 先準備資料（共有三張工作表）

1. 建立三個工作表：

   - `主工作表`（Main） ← 你要輸入公式的地方  
   - `Sheet1` ← A1 儲存格輸入數字 `10`  
   - `Sheet2` ← A1 儲存格輸入數字 `20`

2. 在「主工作表」：
   - A1 輸入 `Sheet1` 或 `Sheet2`（請打正確工作表名稱）
   - B1 輸入公式：

     ```excel
     =INDIRECT("'" & A1 & "'!A1")
     ```

---

## 🧠 拆解這個公式的意思

這條公式其實是組合出一個 **儲存格參照的字串**。

### 公式：
```excel
=INDIRECT("'" & A1 & "'!A1")
```

### 假設 A1 的內容是：`Sheet1`

讓我們來拆開來看這個公式怎麼變化：

| 部分         | 解釋                           | 結果               |
|--------------|--------------------------------|--------------------|
| `A1`         | 儲存格 A1 的內容                | `Sheet1`           |
| `"'" & A1`   | 加上前面的單引號 `'Sheet1`     | `'Sheet1`          |
| `"'" & A1 & "'"` | 加上後面的單引號 `'Sheet1'` | `'Sheet1'`         |
| `"'" & A1 & "'!A1"` | 加上工作表的儲存格位置   | `'Sheet1'!A1`      |

所以整個字串就是：

```excel
=INDIRECT("'Sheet1'!A1")
```

這就等同於直接寫：

```excel
='Sheet1'!A1
```

### 換句話說：

- 如果你在 A1 打的是 `Sheet1` → 就會顯示 `Sheet1!A1` 的值 → 是 `10`
- 如果你在 A1 打的是 `Sheet2` → 就會顯示 `Sheet2!A1` 的值 → 是 `20`

---

## ✅ 實用小技巧

如果你怕拼錯 Sheet 名稱，可以把 A1 做成「下拉選單」：

1. 選取主工作表的 A1 儲存格  
2. 點選上方選單：資料 → 資料驗證  
3. 選擇「清單」  
4. 輸入 `Sheet1,Sheet2`  
5. 這樣 A1 就可以用選的，不怕打錯名稱！

---

## ❓ 1. 為什麼需要加上 `' '` 把 Sheet1 引起來？

### ✅ 答案：
**當工作表名稱中有空格、中文或特殊字元時，必須用單引號 `' '` 包住，Excel 才能正確辨識這是工作表名稱。**

即使 `Sheet1` 本身沒有空格，加上引號也可以避免錯誤，是一種「安全寫法」。

---

### 🔍 舉例：

#### 不加引號的情況（可能會錯）：

```excel
=INDIRECT(Sheet1!A1)
```

這樣會被 Excel 誤解為函數錯誤，因為 `Sheet1!A1` 不是字串，而 `Sheet1` 也不是定義的名稱。

---

#### 正確加上引號的寫法：

```excel
=INDIRECT("'Sheet1'!A1")
```

這樣 Excel 就能正確地理解：  
👉「從 Sheet1 工作表的 A1 儲存格取得資料」。

---

### 💡 延伸補充：

如果你的工作表名稱是：

- `年度報表`（有中文）
- `2025 Summary`（有空格）

那你一定要加上單引號：

```excel
=INDIRECT("'2025 Summary'!A1")
```

---

## ❓ 2. `!A1` 是什麼意思？

### ✅ 答案：
`!A1` 的意思是「指定某一張工作表中的 A1 儲存格」。

---

### 📘 語法結構如下：

```
工作表名稱 + ! + 儲存格位置
```

例如：

| 語法               | 意思                             |
|--------------------|----------------------------------|
| `'Sheet1'!A1`      | Sheet1 工作表中的 A1 儲存格      |
| `'年度報表'!B2`     | 年度報表 工作表中的 B2 儲存格     |
| `'2025 Summary'!C5`| 2025 Summary 工作表中的 C5 儲存格 |

---

### 🔁 回到原來的公式：

```excel
=INDIRECT("'" & A1 & "'!A1")
```

假設 A1 的內容是 `Sheet1`，整個公式會變成：

```excel
=INDIRECT("'Sheet1'!A1")
```

代表「去 Sheet1 這張工作表的 A1 儲存格抓值」。

---

## ✅ 總結

| 元件        | 意思                                      |
|-------------|-------------------------------------------|
| `'` `'`     | 把工作表名稱包起來，避免空格/特殊字元出錯 |
| `!`         | 表示「工作表中的儲存格」                  |
| `A1`        | 指的是欄位 A，第 1 列                     |

---

需要我幫你做一個互動範本（像是選單 + 自動抓值）練習一下嗎？還是你要進一步試試抓整個範圍、不同儲存格？😊

# 🧩 注意事項：

- 如果參照的工作表或儲存格不存在，會回傳 `#REF!`。
- `INDIRECT` 是**不會自動更新的參照**（例如插入列/欄時，它不會調整參照位址）。
- 常搭配 `&` 來組合字串。

---

需要我幫你做一個練習題嗎？還是你有實際案例想要試試？
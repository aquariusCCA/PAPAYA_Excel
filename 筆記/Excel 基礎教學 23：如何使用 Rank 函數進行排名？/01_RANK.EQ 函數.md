> Excel 中的 `RANK.EQ` 函數是用來**計算某個數值在一組數值中的排名**，排名相同的數值會被賦予相同的名次（也就是 “Equal” 的意思）。這個函數在進行成績排名或銷售績效分析時非常有用。

---

# 🧩 函數語法

```excel
RANK.EQ(number, ref, [order])
```

| 參數      | 說明 |
|-----------|------|
| `number`  | 要排名的數值。 |
| `ref`     | 包含要比較排名的數值範圍。 |
| `[order]` | （可選）指定排序方式：<br>`0` 或省略：遞減排序（最大值為第 1 名）<br>`1`：遞增排序（最小值為第 1 名） |

### 📌 RANK.EQ 函數的基本概念
> RANK 代表「排名」，而 EQ 是 Equal（相等）的縮寫。

- 這個函數的基本結構需要提供：
    - 主體（數值）：要進行排名的單一數據。
    - 範圍（數據集）：與主體比較的整體數據範圍。

### 📌 處理相同名次
> 若有**相同的數值**，`RANK.EQ` 會將它們**賦予相同的排名**（相等排名），但**後續名次會跳過對應的數量**，不會重複排名。

假設以下是某場比賽的分數（由高到低）：

| 姓名 | 分數 |
|------|------|
| A    | 95   |
| B    | 92   |
| C    | 92   |
| D    | 90   |
| E    | 88   |

使用公式：
```excel
=RANK.EQ(B2, $B$2:$B$6, 0)
```

結果為：

| 姓名 | 分數 | 排名 |
|------|------|------|
| A    | 95   | 1    |
| B    | 92   | 2    |
| C    | 92   | 2    |
| D    | 90   | 4    |
| E    | 88   | 5    |

🔍 可以看到：
- B 和 C 分數相同，**都排第 2 名**。
- 接下來的 D，**跳過第 3 名，直接為第 4 名**。

##### ⚠️ 注意事項

- 如果你希望排名能夠連續（例如 2 個第 2 名，下一個是第 3 名），可以考慮使用 `RANK.AVG` 函數，它會對相同值的排名取平均值。
- 若資料中有空白或非數字，需注意範圍參考時的資料一致性。


### 📌 處理排序方向
> 在預設情況下，RANK.EQ 採用 遞減排序（數字越大排名越高）。

- 若需要 遞增排序（數字越小排名越高，例如跑步成績），可以加入第三個引數：`=RANK.EQ(時間, 範圍, 1) `
    - 0 或 省略 → 採用遞減排序（數值大者為先）。
    - 1 → 採用遞增排序（數值小者為先）。

---

# 🧪 範例

假設你有以下的學生成績表（放在 A1:B6）：

| 姓名  | 成績 |
|-------|------|
| 小明 | 90   |
| 小華 | 75   |
| 小美 | 90   |
| 小強 | 60   |
| 小芳 | 85   |

你想要知道每個人的**成績排名**，可以在 C 欄輸入 `RANK.EQ` 函數。

### ➤ 在 C2 輸入以下公式（對應小明的成績）：
```excel
=RANK.EQ(B2, $B$2:$B$6, 0)
```

然後向下拖曳填滿 C 欄。

### 結果會是：

| 姓名  | 成績 | 排名 |
|-------|------|------|
| 小明 | 90   | 1    |
| 小華 | 75   | 4    |
| 小美 | 90   | 1    |
| 小強 | 60   | 5    |
| 小芳 | 85   | 3    |

> ✅ 小明和小美都拿到 90 分，所以同樣是第 1 名。  
> ✅ 小芳雖然是第三高分，但因為有兩個第一名，她就是第 3 名（中間不會跳過名次）。

---

如果你想改為由**小的名次為第一名**（遞增排序），可以將公式改為：

```excel
=RANK.EQ(B2, $B$2:$B$6, 1)
```

這樣分數低的會是第 1 名。

---

如果你還想知道如何處理**名次重複時跳過名次**（像是 1, 2, 2, 4），那就要搭配 `RANK.AVG` 函數，我也可以幫你介紹！需要的話跟我說 😄
# ✅ 自訂數值格式是什麼？

**自訂數值格式**是 Excel 的進階功能，讓你可以用「格式代碼」來決定數字、日期、時間等在儲存格中的**顯示方式**。  
👉 即使數據本身沒變，顯示出來的樣子可以大不同！  

---

## ⚙️ 如何設定自訂數值格式？

1. **選取儲存格**
2. 按下 `Ctrl + 1`（或右鍵 ➝「儲存格格式」）
3. 選擇「**數值格式**」裡的「**自訂**」
4. 在「**類型**」欄位輸入格式代碼
5. 按下「確定」

---

## 💡 常見格式代碼結構

```
正數格式 ; 負數格式 ; 零格式 ; 文字格式
```

你可以設定不同情況下的顯示方式，不一定都要寫 4 段，只寫你需要的也可以！

---

## 📦 實用範例

| 目的 | 格式代碼 | 說明 | 結果（以數值 1234 為例） |
|------|----------|------|------------------------|
| 加上千分位逗號 | `#,##0` | 每三位加逗號 | `1,234` |
| 加上單位「元」 | `#,##0" 元"` | 雙引號中可加任何文字 | `1,234 元` |
| 數字前補零 | `00000` | 顯示 5 位數，不足補 0 | `01234` |
| 顯示百分比 | `0%` | 將數值變成百分比 | `123400%`（因為 1234 × 100%） |
| 僅負數為紅色 | `[紅色]-#,##0;#,##0` | 負數為紅色顯示 | `-1,234`（紅色），正數正常 |
| 正負不同格式 | `+0;-0` | 正數前加 +，負數加 - | `+1234` 或 `-1234` |
| 零顯示為「無」 | `0;-0;"無"` | 特別處理 0 的情況 | `無` |
| 文本前加前綴 | `"商品編號："@` | `@` 代表輸入的文字 | `商品編號：ABC123` |

---

# 自訂格式的基本代碼
### 數字格式

##### 🔢 Excel 自訂數字格式的三大符號

| 符號 | 功能說明 | 範例格式 | 範例數值 → 顯示結果 |
|------|----------|-----------|----------------------|
| `#`（井號） | 顯示**有意義的數字**，不顯示多餘的 0 | `#.##` | `5` → `5`，`5.1` → `5.1`，`5.123` → `5.12` |
| `0`（零） | 強制顯示**指定數字位數**，不足補 0 | `00000` | `123` → `00123` |
| `0.00` | 強制顯示**兩位小數** | `5` → `5.00`，`5.1` → `5.10` |
| `?`（問號） | 類似 `#`，但**用空格填補位數**，用來對齊小數點 | `???.??`<br>（整數最多三位，小數兩位） | `5` → `   5.00`<br>`55.5` → ` 55.50`<br>`555.55` → `555.55` |

---

##### 💡 應用小技巧

| 應用目的 | 格式代碼 | 說明 |
|----------|----------|------|
| 對齊整齊的表格（含小數） | `???.??` | 所有數字右邊的小數點會整齊排好 |
| 編號補零（如學號、員工編號） | `0000` | 讓 `1` 顯示成 `0001`，固定四位數 |
| 金額顯示兩位小數 | `#,##0.00` | 例如：`1234` → `1,234.00` |
| 可變動小數位數但不顯示多餘 0 | `#,##0.##` | `1234` → `1,234`；`1234.5` → `1,234.5` |

---

##### 🎯 小結

| 符號 | 功能 |
|------|------|
| `#` | 顯示有數字才出現，不補 0 |
| `0` | 沒數字也補 0，強制顯示 |
| `?` | 補空格對齊，適合排版 |

---

如果你有想套用的實際範例（例如報表欄位、ID 編號、小數對齊等），可以提供我幫你客製格式喔 😊

### 📌 千分位與縮寫顯示

#### 1. `,`（千分位逗號）

- 功能：**每三位數加入逗號**，使數字更易讀。
- 格式：`#,###`
- 範例：  
  - 原始數字：`1000000`  
  - 顯示結果：`1,000,000`

---

#### 2. 數值縮寫（縮小單位 + 加上單位文字）

> Excel 中連續的 `,` 可以讓數值除以千（每一個 `,` 除一次 1000）

##### 📏 範例 1：以「百萬」為單位（M）

- 格式：`#,##0,, "M"`  
- 說明：兩個逗號 `,,` = 除以 1,000,000  
- 範例：  
  - `1000000` → `1M`  
  - `2500000` → `2.5M`（加 `.0` 請用 `#,##0.0,, "M"`）

##### 📏 範例 2：以「千」為單位（K）

- 格式：`#,##0, "K"`  
- 說明：一個逗號 `,` = 除以 1,000  
- 範例：  
  - `100000` → `100K`  
  - `12500` → `12.5K`（加小數格式可用 `#,##0.0, "K"`）

---

#### 🎯 小結

| 目的 | 格式代碼 | 效果範例 |
|------|----------|----------|
| 顯示千分位 | `#,###` | `1234567` → `1,234,567` |
| 顯示為百萬（M） | `#,##0,, "M"` | `5000000` → `5M` |
| 顯示為千（K） | `#,##0, "K"` | `20000` → `20K` |

---

想要加上「元」或其他單位也沒問題，例如：  
- `#,##0,, "M 元"` → `2000000` 顯示為 `2M 元`  
- `#,##0.0,, "百萬"` → `2500000` 顯示為 `2.5百萬`

---

如果你有實際的報表格式需求，我也可以幫你設計自訂格式唷！需要我幫你配個格式嗎？😄

### 📝 自訂格式中的「文字與符號」

---

#### 1. `@`（At 符號）→ 表示儲存格中的「文字內容」

- 功能：將輸入的文字與你指定的內容結合顯示。
- 用法：`@"文字"`（引號內是要加上的內容）

##### 📌 範例

| 格式 | 輸入 | 顯示結果 |
|------|------|-----------|
| `@"等"` | A | A等 |
| `"商品："@` | 鉛筆 | 商品：鉛筆 |
| `"【"@ "】"` | 測試 | 【測試】 |

---

#### 2. `*`（星號）→ 表示「重複某個符號填滿剩餘空間」

- 功能：將指定的符號或文字重複填滿整個儲存格空間（會自動依寬度調整）
- 用法：`*符號`（*後面直接加你想重複的字元）

##### 📌 範例

| 格式 | 輸入 | 顯示結果（視儲存格寬度而定） |
|------|------|--------------------------------|
| `@*.` | 商品 | 商品................... |
| `@*-` | A | A------------------ |
| `$* 0.00` | 12.5 | $      12.50（$ 會對齊） |

👉 `@*.` 的意思是：「顯示輸入內容後，用句點補滿整個儲存格」
👉 `$* 0.00` 的意思是：「顯示 $ 與數字之間自動補空格，讓 $ 貨幣符號在欄位中對齊」

---

#### ✅ 小結

| 符號 | 功能 | 範例說明 |
|------|------|----------|
| `@` | 顯示儲存格內的**文字** | `@"等"` → A → A等 |
| `*` | 重複字元直到填滿儲存格 | `@*.` → A → A.......... |

---

需要我幫你設計一些對齊用的自訂格式，像是**目錄標題**或**帳單金額**樣式嗎？我可以幫你配 👍

### 🎯 自訂數值格式中的「數值顯示條件」

透過「條件」+「格式代碼」，可以根據**數值大小**來變更顯示樣式（例如顏色或格式）。

---

##### 🟥 基本語法結構

```plaintext
[條件1]格式1;[條件2]格式2;格式3
```

最多可以設定 **3 種情況**（正數、負數、零），或者依條件設定。

---

#### 1️⃣ 使用顏色區分數值種類（正、負、零）

```plaintext
[紅色]#;[藍色]-#;[黑色]0
```

| 數值 | 顯示結果 | 顏色 |
|------|----------|------|
| 100  | `100` | 紅色 |
| -50  | `-50` | 藍色 |
| 0    | `0` | 黑色 |

📌 說明：  
- `;` 分隔「正數；負數；零值」格式  
- 顏色放在 `[]` 裡即可套用

---

#### 2️⃣ 使用條件顯示不同顏色（如成績範圍）

```plaintext
[>90]綠色;[>=80]青色;黑色
```

| 數值 | 顯示結果 | 顏色 |
|------|----------|------|
| 95   | `綠色` | 綠色 |
| 85   | `青色` | 青色 |
| 75   | `黑色` | 黑色 |

📌 說明：
- `[>90]綠色`：大於 90 顯示為「綠色」
- `[>=80]青色`：80~90 顯示為「青色」
- 沒有條件的第三段為「其餘數值」

👉 你可以用條件搭配數值或文字，如：
```plaintext
[>500]"高";[>100]"中";"低"
```
→ 數值 > 500 顯示「高」，介於 100~500 顯示「中」，其餘顯示「低」

---

#### ✅ 小結表

| 功能 | 格式 | 效果 |
|------|------|------|
| 根據正負零變色 | `[紅色]#;[藍色]-#;[黑色]0` | 不同數值套不同顏色 |
| 根據範圍顯示文字或顏色 | `[>90]綠色;[>=80]青色;黑色` | 自訂區間格式呈現 |

---

想要我幫你寫成「分數等級」、「業績達標等級」、「金額警示」這類的條件格式嗎？可以說說你的應用情境，我幫你寫 😄

### 🕵️ Excel 自訂格式中的「隱藏數據」技巧

---

#### ✅ 方法 1：`;;;` → 隱藏所有內容

- 格式代碼：`;;;`  
- 說明：將「正數；負數；零值；文字」四個區段**全部設為空白**，就不會顯示任何內容。
- 原始數據仍存在，**僅隱藏顯示**，可用於防止干擾、簡化報表。

##### 📌 範例

| 輸入值 | 格式：`;;;` | 顯示結果 |
|--------|--------------|-----------|
| 123    | `;;;`        | *(空白)* |
| -50    | `;;;`        | *(空白)* |
| 0      | `;;;`        | *(空白)* |
| ABC    | `;;;`        | *(空白)* |

---

#### ✅ 方法 2：空的區段 → 隱藏特定類型的數值

- 原則：只要某個區段（正數、負數、零、文字）為空，就會「隱藏該類型資料」。
- 格式範例：`0;0;;@`  
  - 正數：以 `0` 顯示  
  - 負數：以 `0` 顯示  
  - **零值：隱藏（因為該區段為空）**  
  - 文字：正常顯示 `@`

##### 📌 範例

| 輸入值 | 格式：`0;0;;@` | 顯示結果 |
|--------|----------------|-----------|
| 25     | `0`            | `25` |
| -10    | `0`            | `10` |
| 0      | *(隱藏)*       | *(空白)* |
| Hello  | `@`            | Hello |

---

#### 🎯 小結

| 格式 | 功能說明 | 使用場景 |
|------|----------|-----------|
| `;;;` | 隱藏所有內容 | 保留資料但不顯示，例如遮蔽敏感資訊 |
| `0;0;;@` | 隱藏零值 | 報表中只顯示有意義的數值，忽略 0 |
| `#;;` | 僅顯示正數，負數與零值皆隱藏 | 著重於報表中「正向」資料的呈現 |

---

如果你需要幫忙設定「只顯示非零」、「只顯示負數」、「隱藏某些內容但還能計算」等實用範例，也可以告訴我，我幫你客製 😄

### 🎯 Excel 自訂數值格式：**條件式格式**

透過條件判斷（如 `[>100]`、`[<=8]`）搭配格式，可以讓同一儲存格根據數值不同，顯示不同的文字或格式樣式。

---

#### ✅ 範例 1：依數值判斷顯示「高」或「低」

```plaintext
[>100]"高";[<=100]"低"
```

| 輸入值 | 顯示結果 |
|--------|-----------|
| 150    | 高        |
| 100    | 低        |
| 80     | 低        |

📌 說明：
- `[>100]` → 顯示為 `"高"`
- `[<=100]` → 顯示為 `"低"`

---

#### ✅ 範例 2：判斷電話號碼是否有「區碼」

```plaintext
[<=8]"(區碼) "000-0000;0000-0000
```

| 輸入值（數字） | 顯示結果     | 說明               |
|----------------|----------------|--------------------|
| 22345678        | (區碼) 223-4567 | 共 8 碼，視為有區碼 |
| 98765432        | (區碼) 987-6543 | 共 8 碼，視為有區碼 |
| 123456789       | 1234-5678      | 超過 8 碼，視為無區碼 |

📌 說明：
- `[<=8]`：當數字長度小於等於 8 位時，套用格式 `(區碼) 000-0000`
- 否則，套用格式 `0000-0000`

⚠️ 注意：這個格式假設輸入的是**純數字**，像 02 開頭的電話號碼，通常要先轉成數字儲存才能運作正確。

---

#### ✅ 小結：條件式格式結構

```plaintext
[條件1]格式1;[條件2]格式2;[條件3]格式3
```

你可以依據數值範圍、長度、正負、是否為 0 來設定不同的顯示方式。

---

#### 💡 延伸應用建議

| 使用情境 | 自訂格式 |
|----------|----------|
| 成績 > 60 顯示「及格」，否則「不及格」 | `[>=60]"及格";"不及格"` |
| 銷售金額 > 10000 顯示「★」 | `[>10000]"★";General` |
| 小於 0 顯示紅色數字，其餘不變 | `[紅色][<0]#,##0;#,##0` |

---

如果你想設計「成績等級顯示」、「數值異常警示」、「資料格式智能變化」等實用情境，我可以幫你搭配設計自訂格式喔！需要嗎？😄
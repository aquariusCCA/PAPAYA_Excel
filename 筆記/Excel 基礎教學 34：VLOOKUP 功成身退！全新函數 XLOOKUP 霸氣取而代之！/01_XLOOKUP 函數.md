# 🔍 一、XLOOKUP 是什麼？

`XLOOKUP` 是 Excel 中比 `VLOOKUP` 和 `HLOOKUP` 更強大的查找函數。  
它可以 **垂直或水平查找**，支援 **精確比對**、**模糊比對**，並能 **查不到時給預設值**。

---

# 📌 二、基本語法：

```excel
=XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])
```

| 參數           | 說明 |
|----------------|------|
| `lookup_value` | 要查找的值 |
| `lookup_array` | 要在哪個範圍內找 |
| `return_array` | 找到後要返回的對應值 |
| `if_not_found` | 查不到要顯示什麼（可省略）|
| `match_mode`   | 比對模式（0=精確、1=最接近、2=萬用字元匹配）|
| `search_mode`  | 搜尋方向（1=從前往後，-1=從後往前）|

---

# 🧠 三、實際應用範例

## 🧪 範例 1：基本用法（垂直查找）

📋 資料表：

| A     | B   |
|-------|-----|
| 姓名  | 分數 |
| 小明  | 80  |
| 小華  | 90  |
| 小美  | 85  |

🔍 查「小華」的分數：

```excel
=XLOOKUP("小華", A2:A4, B2:B4)
```

✅ 結果：`90`

---

## 🔙 範例 2：向左查找（傳統 VLOOKUP 無法做到）

📋 資料表：

| A     | B   |
|-------|-----|
| 分數  | 姓名 |
| 80    | 小明 |
| 90    | 小華 |
| 85    | 小美 |

🔍 查「90」的學生是誰：

```excel
=XLOOKUP(90, A2:A4, B2:B4)
```

✅ 結果：`小華`

---

## ❌ 範例 3：自訂錯誤訊息（查不到時顯示文字）

📋 與範例 1 相同

🔍 查「小強」的分數，查不到時顯示「無此人」：

```excel
=XLOOKUP("小強", A2:A4, B2:B4, "無此人")
```

✅ 結果：`無此人`

---

## 📏 範例 4：近似比對（模糊數字比對）

📋 商品價格表：

| A     | B     |
|-------|-------|
| 數量  | 價格  |
| 1     | 100   |
| 5     | 450   |
| 10    | 800   |

🔍 購買「7個」商品時，用「最接近但不超過」的數量對應價格：

```excel
=XLOOKUP(7, A2:A4, B2:B4,, -1)
```

✅ 結果：`450`

> `-1` = 找到最接近但不超過的值（常用於價格區間）

---

## ↔️ 範例 5：橫向查找（水平）

📋 資料表：

| A     | B     | C     | D     |
|-------|-------|-------|-------|
| 科目  | 國文  | 英文  | 數學  |
| 分數  | 80    | 90    | 70    |

🔍 查「英文」分數：

```excel
=XLOOKUP("英文", B1:D1, B2:D2)
```

✅ 結果：`90`

---

## ✨ 範例 6：模糊查找（萬用字元）

📋 資料表：

| A         | B   |
|-----------|-----|
| 商品名稱   | 價格 |
| 蘋果手機13 | 25000 |
| 蘋果手機14 | 30000 |
| 三星S22    | 27000 |

🔍 查「名稱中有 '13' 的商品價格」：

```excel
=XLOOKUP("*13*", A2:A4, B2:B4, "查無商品", 2)
```

✅ 結果：`25000`

> `*13*` 使用萬用字元 `*` 表示「含有」  
> `2` 表示萬用字元比對（模糊比對）

---

## 🔄 範例 7：逆向查找（從下往上找）

📋 商品出貨記錄（從舊到新）：

| A         | B   |
|-----------|-----|
| 商品      | 日期 |
| A001      | 2023/01/01 |
| A002      | 2023/01/02 |
| A001      | 2023/01/10 |

🔍 查商品 A001「最新」的出貨日期（從下往上找第一筆）：

```excel
=XLOOKUP("A001", A2:A4, B2:B4,, 0, -1)
```

✅ 結果：`2023/01/10`

---

## 🔄 範例 8：雙向篩選（列與欄都需查找）

📋 學生成績表：

| A     | B     | C     | D     |
|-------|-------|-------|-------|
|       | 國文  | 英文  | 數學  |
| 小明  | 80    | 75    | 90    |
| 小華  | 70    | 85    | 88    |
| 小美  | 95    | 89    | 92    |

🔍 查「小華的英文分數」：

```excel
=XLOOKUP("小華", A2:A4, XLOOKUP("英文", B1:D1, B2:D4))
```

✅ 結果：`85`

🧠 解說：內層 `XLOOKUP("英文", B1:D1, B2:D4)` 找到「英文」欄 → 傳回整欄資料  
再用外層 `XLOOKUP("小華", A2:A4, ...)` 找到對應列的值

---

如果你想要我幫你做 Excel 檔的範例表格，我也可以幫你製作一份練習檔案喔 😄 要嗎？